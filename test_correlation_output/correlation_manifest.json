{
  "target_flow_id": "flow_0",
  "metadata": {
    "total_candidates": 99,
    "top_k_for_siamese": 20,
    "statistical_weight": 0.7,
    "siamese_weight": 0.3,
    "duration_seconds": 0.194389,
    "timestamp": "2025-12-15T16:04:50.171671",
    "model_info": {
      "total_parameters": 10560,
      "trainable_parameters": 10560,
      "device": "mps:0",
      "architecture": {
        "input_dim": 300,
        "encoder_type": "1D_CNN",
        "conv_layers": "32->64",
        "output_dim": 64,
        "similarity_method": "cosine"
      }
    }
  },
  "top_10_candidates": [
    {
      "flow_id": "flow_65",
      "statistical": 0.9042347752006743,
      "siamese": 0.7292298674583435,
      "final": 0.851733302877975,
      "rank": 1,
      "guard_identifier": "flow_65",
      "aggregated_evidence": {
        "guard_id": "flow_65",
        "score": 0.9723814643170047,
        "confidence": 0.7014249582112456,
        "count": 3,
        "first_seen": "2025-12-15T16:01:09.606205",
        "last_seen": "2025-12-15T16:04:50.103994",
        "evidence_history": [
          "2025-12-15T16:01:09.606205",
          "2025-12-15T16:03:55.097376",
          "2025-12-15T16:04:50.103994"
        ]
      },
      "tor_relay_info": null,
      "is_known_relay": false
    },
    {
      "flow_id": "flow_91",
      "statistical": 0.9032457950420505,
      "siamese": 0.7303988933563232,
      "final": 0.8513917245363323,
      "rank": 2,
      "guard_identifier": "flow_91",
      "aggregated_evidence": {
        "guard_id": "flow_91",
        "score": 1.180824273205413,
        "confidence": 0.851784661557382,
        "count": 3,
        "first_seen": "2025-12-15T16:01:09.584280",
        "last_seen": "2025-12-15T16:04:50.105018",
        "evidence_history": [
          "2025-12-15T16:01:09.584280",
          "2025-12-15T16:03:55.086552",
          "2025-12-15T16:04:50.105018"
        ]
      },
      "tor_relay_info": null,
      "is_known_relay": false
    },
    {
      "flow_id": "flow_9",
      "statistical": 0.9032060487506017,
      "siamese": 0.7302583456039429,
      "final": 0.851321737806604,
      "rank": 3,
      "guard_identifier": "flow_9",
      "aggregated_evidence": {
        "guard_id": "flow_9",
        "score": 1.076748190015447,
        "confidence": 0.7767096370107263,
        "count": 3,
        "first_seen": "2025-12-15T16:01:09.585877",
        "last_seen": "2025-12-15T16:04:50.105844",
        "evidence_history": [
          "2025-12-15T16:01:09.585877",
          "2025-12-15T16:03:55.101770",
          "2025-12-15T16:04:50.105844"
        ]
      },
      "tor_relay_info": null,
      "is_known_relay": false
    },
    {
      "flow_id": "flow_79",
      "statistical": 0.902318501499145,
      "siamese": 0.7300482988357544,
      "final": 0.8506374407001278,
      "rank": 4,
      "guard_identifier": "flow_79",
      "aggregated_evidence": {
        "guard_id": "flow_79",
        "score": 0.9714288666174057,
        "confidence": 0.7007378042226587,
        "count": 3,
        "first_seen": "2025-12-15T16:01:09.591231",
        "last_seen": "2025-12-15T16:04:50.106493",
        "evidence_history": [
          "2025-12-15T16:01:09.591231",
          "2025-12-15T16:03:55.163857",
          "2025-12-15T16:04:50.106493"
        ]
      },
      "tor_relay_info": null,
      "is_known_relay": false
    },
    {
      "flow_id": "flow_62",
      "statistical": 0.9008412736638627,
      "siamese": 0.7303458452224731,
      "final": 0.8496926451314458,
      "rank": 5,
      "guard_identifier": "flow_62",
      "aggregated_evidence": {
        "guard_id": "flow_62",
        "score": 0.9722885211136102,
        "confidence": 0.7013579138619348,
        "count": 3,
        "first_seen": "2025-12-15T16:01:09.592417",
        "last_seen": "2025-12-15T16:04:50.107149",
        "evidence_history": [
          "2025-12-15T16:01:09.592417",
          "2025-12-15T16:03:55.140183",
          "2025-12-15T16:04:50.107149"
        ]
      },
      "tor_relay_info": null,
      "is_known_relay": false
    },
    {
      "flow_id": "flow_8",
      "statistical": 0.9018579291975768,
      "siamese": 0.7272772789001465,
      "final": 0.8494837341083477,
      "rank": 6,
      "guard_identifier": "flow_8",
      "aggregated_evidence": {
        "guard_id": "flow_8",
        "score": 0.9714258706498514,
        "confidence": 0.7007356430888921,
        "count": 3,
        "first_seen": "2025-12-15T16:01:09.590633",
        "last_seen": "2025-12-15T16:04:50.107797",
        "evidence_history": [
          "2025-12-15T16:01:09.590633",
          "2025-12-15T16:03:55.159170",
          "2025-12-15T16:04:50.107797"
        ]
      },
      "tor_relay_info": null,
      "is_known_relay": false
    },
    {
      "flow_id": "flow_38",
      "statistical": 0.9013151593763022,
      "siamese": 0.7284096479415894,
      "final": 0.8494435059458882,
      "rank": 7,
      "guard_identifier": "flow_38",
      "aggregated_evidence": {
        "guard_id": "flow_38",
        "score": 1.0765644226525486,
        "confidence": 0.776577076879161,
        "count": 3,
        "first_seen": "2025-12-15T16:01:09.598423",
        "last_seen": "2025-12-15T16:04:50.108439",
        "evidence_history": [
          "2025-12-15T16:01:09.598423",
          "2025-12-15T16:03:55.074839",
          "2025-12-15T16:04:50.108439"
        ]
      },
      "tor_relay_info": null,
      "is_known_relay": false
    },
    {
      "flow_id": "flow_14",
      "statistical": 0.9006805827703945,
      "siamese": 0.7297598123550415,
      "final": 0.8494043516457886,
      "rank": 8,
      "guard_identifier": "flow_14",
      "aggregated_evidence": {
        "guard_id": "flow_14",
        "score": 1.0726689925014248,
        "confidence": 0.7737671179985831,
        "count": 3,
        "first_seen": "2025-12-15T16:01:09.586687",
        "last_seen": "2025-12-15T16:04:50.109075",
        "evidence_history": [
          "2025-12-15T16:01:09.586687",
          "2025-12-15T16:03:55.159810",
          "2025-12-15T16:04:50.109075"
        ]
      },
      "tor_relay_info": null,
      "is_known_relay": false
    },
    {
      "flow_id": "flow_30",
      "statistical": 0.9008994862852515,
      "siamese": 0.7283436059951782,
      "final": 0.8491327221982296,
      "rank": 9,
      "guard_identifier": "flow_30",
      "aggregated_evidence": {
        "guard_id": "flow_30",
        "score": 0.9712511651996297,
        "confidence": 0.7006096197455666,
        "count": 3,
        "first_seen": "2025-12-15T16:01:09.592118",
        "last_seen": "2025-12-15T16:04:50.109820",
        "evidence_history": [
          "2025-12-15T16:01:09.592118",
          "2025-12-15T16:03:55.156607",
          "2025-12-15T16:04:50.109820"
        ]
      },
      "tor_relay_info": null,
      "is_known_relay": false
    },
    {
      "flow_id": "flow_16",
      "statistical": 0.9005211663316905,
      "siamese": 0.7289461493492126,
      "final": 0.8490486612369471,
      "rank": 10,
      "guard_identifier": "flow_16",
      "aggregated_evidence": {
        "guard_id": "flow_16",
        "score": 0.9721149624550953,
        "confidence": 0.7012327177539635,
        "count": 3,
        "first_seen": "2025-12-15T16:01:09.591523",
        "last_seen": "2025-12-15T16:04:50.110626",
        "evidence_history": [
          "2025-12-15T16:01:09.591523",
          "2025-12-15T16:03:55.140935",
          "2025-12-15T16:04:50.110626"
        ]
      },
      "tor_relay_info": null,
      "is_known_relay": false
    }
  ],
  "notes": {
    "statistical_weight": 0.7,
    "siamese_weight": 0.3,
    "description": "Probabilistic similarity ranking - NOT classification",
    "sumo_features_excluded": true
  }
}